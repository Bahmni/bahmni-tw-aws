---

- ec2_vpc_subnet_facts:
    region: "{{ aws_region }}"
    filters:
       vpc-id: "{{ VpcId }}"
  register: subnet_facts

- name: Populate public Subnet
  set_fact:
    PublicSubnet: "{{ subnet_facts.subnets | selectattr('tags.Name', 'equalto', 'public') | list }}"

- name: Populate qa Subnet
  set_fact:
    QASubnet: "{{ subnet_facts.subnets | selectattr('tags.Name', 'equalto', 'qa') | list }}"

- name: Fetch SubnetIds
  set_fact:
    PublicSubnetId: "{{ PublicSubnet[0].id }}"
    QASubnetId: "{{ QASubnet[0].id }}"